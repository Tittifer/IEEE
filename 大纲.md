**身份认证：**



- **方案一：**

1. 用户在首次注册账户时，电网向用户发送一个可验证凭证，包含用户DID，车辆信息等
2. 用户在连接充电桩时，链上通过充电桩向用户发送出示请求，声明需要哪些凭证，充电桩在收到凭证后提交给链上合约
3. 合约收到请求后检查是否有所需凭证，身份验证通过后，充电桩调用风险评估相关合约，运行预定义的评分算法计算实时风险分数
4. 根据计算的风险分数，链上调用风险策略合约限制用户行为

- **方案二：**

1. 用户在首次注册账户时，电网向用户发送一个可验证凭证，包含用户DID，车辆信息等，同时生成用户的风险凭证，发送给链下风险预言机
2. 用户在连接充电桩时，链上通过充电桩向用户发送出示请求，声明需要哪些凭证，充电桩在收到凭证后提交给链上合约
3. 合约收到请求后检查是否有所需凭证，身份验证通过后，合约向风险预言机发送包含用户DID的查询请求
4. 风险预言机收到请求后在其风险数据库中查询用户历史行为，运行风险评估模型计算用户实时风险等级并将其返还给合约
5. 合约根据返回的用户风险等级执行预设策略限制用户行为

------

**攻击方式：**

1. 虚假数据注入攻击（FDI）：通过篡改通信链路（如RS-485或无线网络）中的数据来实现，攻击者向控制系统发送错误的发电功率或电压信息，导致电网调度中心做出错误决策，引发频率波动或保护误动，影响系统稳定性和用户收益。
2. 拒绝服务攻击：针对逆变器与融合终端或云平台之间的通信通道，通过泛洪攻击耗尽网络资源，使逆变器无法接收控制指令或上传数据，在电网异常时失去功率调节能力，可能加剧局部电压或频率失稳，甚至引发连锁故障。
3. 中间人攻击：劫持逆变器与控制设备之间的通信会话，攻击者伪装成合法实体注入恶意指令，例如篡改功率设定值或固件更新包，导致逆变器行为异常，长期可能形成僵尸网络，为协同攻击埋下隐患。
4. 重放攻击：利用截获的历史控制指令，在不适当时刻重新发送给逆变器，由于部分设备缺乏时间戳校验，逆变器会误执行指令，造成发电量无故削减或并网同步问题，影响经济性和设备安全。
5. 固件篡改：通过漏洞利用或未加密接口植入恶意代码，攻击者可远程控制逆变器或修改其运行逻辑，使其在频率响应或低压穿越功能中失效，不仅破坏本地运行，还可能成为攻击电网的跳板，扩大故障范围。

------

**方案设计：**

- **配网状态估计技术：**通过配电系统量测信息与伪量测数据估算实时运行状态
- **虚假数据注入攻击：**传感器通过识别前端的数据，并通过网络传输给控制系统，在传输过程中篡改网络通信的数据包，导致控制系统收到的数据为错误的数据，控制系统基于错误的数据进行识别分析进行控制策略实施

蜜点伪装成配电网状态估计系统中的关键量测节点，模拟真实量测数据流或通信协议

------

**风险评估算法：**

- 分数更新：

$$
\rm S_t= min(S_{max},(Score+S_{t-1}^{'}) \cdot \lambda)
$$

​		$\rm S_t$：本次计算分数

​		$\rm S_{max}$：最高得分		

- 得分归一化：

$$
\rm Score=\sum_{i=1}^{5}{\frac{R_i}{M_i}} \cdot 100
$$

​		$\rm R_i$：每个维度实际得分

​		$\rm M_i$：每个维度最大得分

- 历史风险行为影响因子：

$$
\rm \lambda=1+\frac{\sum_{j=1}^{N}{e^{-\beta(t-t_j)}} \cdot S_{p,j}}{T}
$$

​		$\rm N$：用户历史风险行为记录总数

​		$\rm T$：风险分数归一化基数

​		$\rm \beta$：衰减速率系数

​		$\rm S_{p,j}$：第j次风险行为的分数

​		$\rm t_j$：第j次风险行为发生时间

- 降温曲线：

$$
\rm S_{t-1}^{'}=max(0,S_{t-1}-\frac{\delta*\Delta t}{1+\alpha*S_{t-1}})
$$

​		$\rm S_{t-1}$：上次计算得分

​		$\rm \delta$：影响低分时降温速度参数

​		$\rm \Delta t$：上次风险行为和本次风险行为的时间间隔

​		$\rm \alpha$：影响高分时降温速度参数

------

**DAG实现链式蜜点：**

- 研究背景：

  ​	配电网智能化，电动汽车充电桩即插即用特性极大扩展了攻击面，传统安全架构难以应对针对配电网的APT攻击，因而需要能诱捕，识别，快速响应的防御体系

- 研究方法：

  ​	采用区块链技术构建分布式信任基础设施，实现用户身份和操作权限的去中心化管理。

  ​	设计面向配电网业务流程的有向无环图蜜点架构，在配电云平台、融合终端、智能开关、充电桩、逆变器等关键节点部署多层次蜜点。通过模拟真实业务交互，引导攻击者深入渗透的诱捕环境，形成从边界探测到核心业务访问的完整攻击链条，实现攻击行为的早期发现和全程监控。

  ​	基于攻击者在DAG蜜点网络中的遍历路径，构建多维度风险评估模型，综合考虑节点重要性、技术难度、访问时间间隔等特征进行动态评分，对不同节点及攻击者调用路径给予不同风险评分。设计分级响应策略，根据风险等级自动触发从增强监控、访问限制到会话阻断的递进式防护措施，实现精准有效的威胁处置，最大限度降低对正常配电业务的影响。

**DAG结构拓扑：**

- 节点：代表配电网中的关键资产和服务，每个节点都是一个独立的蜜点
- 有向边：代表节点之间合法的数据流或控制命令流，边的方向代码攻击者可能的渗透路径

**蜜点设计：**

- 模仿配电网关键协议，可以响应请求，生成符合协议规范，包含虚假配电数据的报文
- 模仿真实业务交互，给予攻击者期望的信息以诱导其前往下个蜜点位置
- 模拟重要文件作为诱饵，放置在攻击者可能访问的节点上，并引导其至深层蜜点网络
- 记录蜜点中出入流量数据，提取攻击者行为数据推断其最终目的
- 将攻击者在DAG网络中的所有行为绘制成攻击路径图，所有捕获的流量数据都与路径图上特定的节点和边关联

**多维度风险评估：**

- 根据攻击行为在蜜点网络中的上下文和路径，进行动态评估
- 评估指标：攻击者当前所在或试图访问的蜜点所模拟的资产在真实电网中的关键程度。攻击者移动路径是否表现出明确的目标性。攻击者的行为与正常用户行为模式的偏离程度。访问速度是否正常，访问时间是否在业务非高峰期。（利用图神经网络？）

**分级响应策略：**

- 低风险响应：对用户后续行为进行更详细日志记录，限制其连接频率，主动引导其进入更具吸引力的蜜点
- 中风险用户：限制其IP访问真实业务系统，仅允许其与蜜点交互，继续观察其攻击手法
- 高风险用户：终止其网络连接，禁止用户继续登录

**风险评估规则：**

| 评估项目       | 具体情形                | 情形描述                   | 得分 |
| -------------- | ----------------------- | -------------------------- | ---- |
| **路径深度**   | 边缘蜜点                | 访问非关键蜜点             | 2分  |
|                | 业务蜜点                | 访问业务处理类蜜点         | 6分  |
|                | 核心蜜点                | 访问模拟核心控制系统的蜜点 | 9分  |
| **路径复杂度** | 线性访问                | 按预设路径顺序访问蜜点     | 1分  |
|                | 多分支访问              | 在多个蜜点分支间跳跃访问   | 4分  |
|                | 跨域横向移动            | 跨越不同安全域访问蜜点     | 7分  |
| **权限提升**   | 无权限提升              | 保持初始权限访问蜜点       | 0分  |
|                | 普通权限提升            | 获取普通用户权限蜜点访问权 | 4分  |
|                | 系统/管理员权限蜜点访问 | 访问模拟高权限系统的蜜点   | 7分  |
| **节点关键性** | 信息展示类蜜点          | 访问只读信息类蜜点         | 1分  |
|                | 数据采集类蜜点          | 访问数据采集模拟节点       | 4分  |
|                | 业务控制类蜜点          | 访问业务控制模拟节点       | 7分  |
|                | 核心控制类蜜点          | 访问模拟核心控制系统的蜜点 | 10分 |
| **操作危险性** | 无害探测                | 仅调用信息查询接口         | 0分  |
|                | 敏感信息查询            | 调用敏感信息接口           | 2分  |
|                | 参数修改尝试            | 调用参数修改接口           | 5分  |
|                | 控制指令尝试            | 调用控制指令接口           | 8分  |
| **目标性**     | 随机扫描                | 无目标调用多个蜜点         | 1分  |
|                | 有目标但路径错误        | 目标明确但调用路径不合理   | 3分  |
|                | 精准调用高价值蜜点      | 直接调用高价值蜜点接口     | 6分  |
| **调用频率**   | 低频调用                | 调用间隔 > 10分钟          | 1分  |
|                | 中频调用                | 调用间隔 1-10分钟          | 3分  |
|                | 高频调用                | 调用间隔 < 1分钟           | 6分  |

- 一票否决：
  - 调用模拟破坏性指令的蜜点接口
  - 调用模拟系统最高权限的蜜点接口
  - 同时从多个入口调用蜜点，表现出协同攻击特征
